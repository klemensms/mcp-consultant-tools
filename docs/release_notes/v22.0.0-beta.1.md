# Release v22.0.0-beta.1

**Release Date:** TBD
**Type:** Major Release
**Status:** Beta Testing

## Overview

Version 22.0.0 introduces the **REST API Integration** - a new MCP server for testing HTTP endpoints with comprehensive authentication support, including automatic OAuth2 client credentials flow for JWT token generation. This enables AI assistants to test REST APIs protected by Azure AD/Entra ID without manually managing bearer tokens.

## Breaking Changes

None.

## New Features

### REST API Integration (`@mcp-consultant-tools/rest-api`)

**New Package:** A complete MCP server for REST API testing.

#### Key Capabilities

- **HTTP Methods**: Full support for GET, POST, PUT, DELETE, PATCH
- **OAuth2 Client Credentials**: Automatic JWT token acquisition with intelligent caching (5-minute refresh buffer)
- **Multiple Auth Methods**: OAuth2, static bearer, basic auth, API key
- **Response Management**: Configurable size limits with smart truncation
- **Batch Operations**: Execute multiple requests sequentially with optional stop-on-error
- **Custom Headers**: Configure persistent headers via `HEADER_*` environment variables
- **SSL Control**: Enable/disable certificate verification for development environments

#### New Tools (4)

| Tool | Description |
|------|-------------|
| `rest-request` | Execute a single HTTP request with automatic authentication |
| `rest-config` | Get current service configuration summary |
| `rest-refresh-token` | Force refresh OAuth2 access token cache |
| `rest-batch-request` | Execute multiple requests sequentially |

#### New Prompts (2)

| Prompt | Description |
|--------|-------------|
| `rest-api-guide` | Comprehensive guide for using REST API testing tools |
| `rest-api-troubleshoot` | Troubleshooting guide for common issues |

#### Use Cases

- **Data API Builder (DAB) Testing**: Test Azure DAB APIs with automatic Entra ID authentication
- **API Development**: Test endpoints during development with configurable auth
- **Integration Testing**: Validate API workflows using batch requests
- **Troubleshooting**: Debug API issues with detailed request/response information

## Changes to Existing Features

None.

## Beta Testing Configuration

### REST API Integration

```json
{
  "mcpServers": {
    "rest-api": {
      "command": "npx",
      "args": ["-y", "@mcp-consultant-tools/rest-api@beta"],
      "env": {
        "REST_BASE_URL": "https://your-api.example.com",
        "OAUTH2_TOKEN_URL": "https://login.microsoftonline.com/{tenant-id}/oauth2/v2.0/token",
        "OAUTH2_CLIENT_ID": "your-client-id",
        "OAUTH2_CLIENT_SECRET": "your-client-secret",
        "OAUTH2_SCOPE": "api://your-app-id/.default"
      }
    }
  }
}
```

### Without OAuth2 (Simple Bearer Token)

```json
{
  "mcpServers": {
    "rest-api": {
      "command": "npx",
      "args": ["-y", "@mcp-consultant-tools/rest-api@beta"],
      "env": {
        "REST_BASE_URL": "https://httpbin.org",
        "AUTH_BEARER": "your-static-token"
      }
    }
  }
}
```

### Public API Testing (No Auth)

```json
{
  "mcpServers": {
    "rest-api": {
      "command": "npx",
      "args": ["-y", "@mcp-consultant-tools/rest-api@beta"],
      "env": {
        "REST_BASE_URL": "https://httpbin.org"
      }
    }
  }
}
```

## Beta Testing Checklist

### REST API Integration

- [ ] **Basic connectivity**: Server starts and responds to tool calls
  - Run `rest-config` to verify configuration is loaded
- [ ] **Public API test**: Test against httpbin.org (no auth required)
  - Run `rest-request` with `method: "GET"`, `endpoint: "/get"`
- [ ] **OAuth2 authentication**: Test with Azure AD protected API
  - Configure OAuth2 environment variables
  - Run `rest-request` and verify automatic token acquisition
  - Run `rest-refresh-token` and verify token cache is cleared
- [ ] **Batch operations**: Test multiple sequential requests
  - Run `rest-batch-request` with 2-3 requests
  - Test `stopOnError: true` behavior
- [ ] **Response truncation**: Verify large responses are properly truncated
  - Request endpoint returning large payload
  - Check `validation.truncated` in response
- [ ] **Error handling**: Verify errors are properly reported
  - Test 404, 401, 500 responses
  - Test connection errors (invalid host)
- [ ] **Host override**: Test `host` parameter for cross-server requests
  - Run `rest-request` with custom `host` parameter
- [ ] **Custom headers**: Test `HEADER_*` environment variables
  - Add custom header and verify it's sent

### Environment Variables to Test

| Variable | Description | Test Value |
|----------|-------------|------------|
| `REST_BASE_URL` | Base URL (required) | `https://httpbin.org` |
| `REST_RESPONSE_SIZE_LIMIT` | Max response size | `5000` |
| `REST_ENABLE_SSL_VERIFY` | SSL verification | `false` (for self-signed) |
| `REST_TIMEOUT` | Request timeout | `10000` |
| `HEADER_*` | Custom headers | `HEADER_Accept=application/json` |

## Support

Report issues at: https://github.com/klemensms/mcp-consultant-tools/issues
