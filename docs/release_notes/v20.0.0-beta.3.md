# Release v20.0.0-beta.3

**Note:** This is a beta release. Please test thoroughly before production use.

**Package Status (Selective Publishing):**
- **@mcp-consultant-tools/powerplatform**: v20.0.0-beta.3 ⭐ (updated)
- All other packages: v20.0.0-beta.2

**Changes from beta.2:**
- **Fixed:** Option Set Scope validation now correctly reports as MUST (critical) instead of SHOULD (warning)
  - Local option sets will now appear in "Critical Violations" section
  - Aligns implementation with documentation

**Changes from beta.1:**
- Added `requiredColumns` parameter to `validate-dataverse-best-practices` tool for flexible required column validation (e.g., SQL timestamp columns)
- Fixed Option Set Scope validation severity (SHOULD → MUST)

## Breaking Changes

None

## New Features

### PowerPlatform: Dataverse Best Practices Validation

Added `validate-dataverse-best-practices` tool for automated validation of entity schema against internal best practices.

**What it checks:**
- Publisher prefix compliance (e.g., `sic_`)
- Schema name lowercase requirements
- Lookup column naming conventions (must end with `id`)
- Option set scope (prefers global over local)
- Required column existence (`sic_updatedbyprocess` for non-RefData tables)
- Entity icon assignment

**Key features:**
- Validates entire solutions or specific entities
- Time-based filtering (e.g., columns created in last 30 days)
- Configurable rule selection
- Detailed violation reports with actionable recommendations
- Distinguishes between critical (MUST fix) and warnings (SHOULD fix)

**Tool parameters:**
- `solutionUniqueName` - Validate entire solution
- `entityLogicalNames` - Validate specific entities
- `publisherPrefix` - Publisher prefix to check against (required)
- `recentDays` - Only check columns created in last N days (default: 30, 0 = all)
- `includeRefDataTables` - Include RefData tables (default: true)
- `rules` - Which rules to validate (default: all)
- `maxEntities` - Safety limit for large solutions
- `requiredColumns` - **NEW in beta.2**: List of required column schema names to validate. Use `{prefix}` placeholder (replaced with `publisherPrefix` at runtime). Default: `["{prefix}updatedbyprocess"]`. **Use case:** Enforce SQL timestamp columns for bi-directional sync: `["{prefix}sqlcreatedon", "{prefix}sqlmodifiedon"]`

**Beta Testing Configuration:**

**For beta.3: Test PowerPlatform package only** (selective publishing - only this package updated):

```json
{
  "mcpServers": {
    "powerplatform-beta": {
      "command": "npx",
      "args": ["-y", "@mcp-consultant-tools/powerplatform@beta"],
      "env": {
        "POWERPLATFORM_URL": "https://yourenvironment.crm.dynamics.com",
        "POWERPLATFORM_CLIENT_ID": "your-client-id",
        "POWERPLATFORM_CLIENT_SECRET": "your-client-secret",
        "POWERPLATFORM_TENANT_ID": "your-tenant-id",
        "AZUREDEVOPS_ORGANIZATION": "your-org",
        "AZUREDEVOPS_PAT": "your-pat",
        "AZUREDEVOPS_PROJECTS": "project1,project2",
        "FIGMA_API_KEY": "your-figma-token",
        "APPINSIGHTS_APP_ID": "your-app-id",
        "APPINSIGHTS_API_KEY": "your-api-key",
        "LOGANALYTICS_WORKSPACE_ID": "your-workspace-id",
        "AZURESQL_SERVERS": "server1.database.windows.net,server2.database.windows.net",
        "SERVICEBUS_NAMESPACE": "your-namespace.servicebus.windows.net",
        "SERVICEBUS_CONNECTION_STRING": "your-connection-string",
        "SHAREPOINT_TENANT_ID": "your-tenant-id",
        "SHAREPOINT_CLIENT_ID": "your-client-id",
        "SHAREPOINT_CLIENT_SECRET": "your-secret",
        "GITHUB_ENTERPRISE_TOKEN": "your-token",
        "GITHUB_ENTERPRISE_BASE_URL": "https://github.yourcompany.com/api/v3"
      }
    }
  }
}
```

Or test individual packages (replace `powerplatform-readonly` with any package name):

```json
{
  "mcpServers": {
    "powerplatform-readonly": {
      "command": "npx",
      "args": ["@mcp-consultant-tools/powerplatform@beta"],
      "env": {
        "POWERPLATFORM_URL": "https://yourenvironment.crm.dynamics.com",
        "POWERPLATFORM_CLIENT_ID": "your-client-id",
        "POWERPLATFORM_CLIENT_SECRET": "your-client-secret",
        "POWERPLATFORM_TENANT_ID": "your-tenant-id"
      }
    }
  }
}
```

**Testing checklist:**
- [ ] Install and run: `npx mcp-consultant-tools@beta`
- [ ] Verify all configured integrations load without errors
- [ ] Test authentication for each configured service
- [ ] Verify environment variables are read correctly
- [ ] Test at least 2-3 tools from each enabled integration
- [ ] Test at least 1 prompt from each enabled integration
- [ ] **NEW: Test PowerPlatform best practices validation:**
  - [ ] Run `validate-dataverse-best-practices` with a test solution
  - [ ] Verify it detects uppercase column names
  - [ ] Verify it detects lookups without `id` suffix
  - [ ] Verify it detects missing `sic_updatedbyprocess` column
  - [ ] Test time filtering with `recentDays` parameter
  - [ ] Verify RefData tables skip `updatedbyprocess` check
  - [ ] **NEW in beta.2**: Test custom `requiredColumns` parameter
    - [ ] Pass `requiredColumns: ["{prefix}sqlcreatedon", "{prefix}sqlmodifiedon"]`
    - [ ] Verify it detects entities missing these columns
    - [ ] Verify violations show correct column names (e.g., `sic_sqlcreatedon`)
    - [ ] Test with multiple custom columns simultaneously
- [ ] Verify error messages are clear and helpful
- [ ] Check that unconfigured integrations are gracefully skipped
- [ ] Test with Claude Desktop (or your MCP client)
- [ ] Verify no regressions from previous version (17.0.3)

**Available packages:**
- `@mcp-consultant-tools/core` - Shared utilities (v20.0.0-beta.2)
- `@mcp-consultant-tools/powerplatform` - PowerPlatform read-only (39 tools, 11 prompts) - **Enhanced validation tool**
- `@mcp-consultant-tools/powerplatform-customization` - PowerPlatform schema changes (40 tools, 2 prompts)
- `@mcp-consultant-tools/powerplatform-data` - PowerPlatform data CRUD (3 tools, 0 prompts)
- `@mcp-consultant-tools/azure-devops` - Azure DevOps (18 tools, 6 prompts)
- `@mcp-consultant-tools/figma` - Figma (2 tools, 0 prompts)
- `@mcp-consultant-tools/application-insights` - Application Insights (10 tools, 5 prompts)
- `@mcp-consultant-tools/log-analytics` - Log Analytics (10 tools, 5 prompts)
- `@mcp-consultant-tools/azure-sql` - Azure SQL (11 tools, 3 prompts)
- `@mcp-consultant-tools/service-bus` - Service Bus (8 tools, 5 prompts)
- `@mcp-consultant-tools/sharepoint` - SharePoint Online (15 tools, 5 prompts)
- `@mcp-consultant-tools/github-enterprise` - GitHub Enterprise (22 tools, 5 prompts)
- `mcp-consultant-tools` - Meta-package (all integrations)

## Changes to Existing Features

### PowerPlatform: Option Set Validation Severity Upgraded

**Fixed:** The Option Set Scope validation rule now correctly reports as **MUST** (critical) instead of **SHOULD** (warning).

- **What changed**: Local option sets are now treated as critical violations, not just warnings
- **Why**: Global option sets are a fundamental best practice for maintainability and reusability
- **Impact**: Validation reports will show local option sets as critical violations that must be fixed
- **Documentation**: The documentation already specified MUST - this aligns the implementation with the docs

**Affected tool:** `validate-dataverse-best-practices` - Option Set Scope rule

### Release Infrastructure Improvements

- **Coordinated monorepo release**: All 13 packages now version-aligned at v20.0.0-beta.1
  - Previously, packages had different version numbers (1.0.x, 2.0.x, etc.)
  - Now all packages share the same major version for easier tracking
  - Simplifies dependency management and compatibility

- **Enhanced publish script** (`scripts/publish-all.sh`):
  - Added `--tag` parameter support for beta/rc releases
  - Improved verification with retry logic (handles npm registry propagation delays)
  - Better error messages and user prompts
  - Publishes all packages in correct dependency order

- **Improved release documentation**:
  - Added structured release process in RELEASE_PROCESS.md
  - Release notes now serve as beta testing checklist
  - Clear workflow: beta → test → iterate → finalize → production

### What Users Should Notice

- **More reliable installations**: Improved package publishing reduces installation errors
- **Consistent versioning**: Easier to track which versions work together
- **Better error handling**: More informative error messages during package installation

---

## Notes

This release focuses on infrastructure improvements to support safer, more reliable releases. The version bump to v20.0.0 establishes a new baseline for coordinated releases across the monorepo.

**Why test this beta:**
- Verify the version alignment doesn't introduce any unexpected issues
- Ensure all integrations still work correctly with the new package structure
- Confirm that the improved publishing process results in reliable installations

**Expected behavior:**
- Should work identically to v17.0.3 for all user-facing functionality
- All existing tools, prompts, and configurations should work unchanged
- No migration or configuration changes required
