# Release v22.0.0

**Release Date:** 2025-12-05
**Type:** Major Release

## Overview

Version 22.0.0 introduces the **Azure AD B2C integration**, **REST API package with OpenAPI auto-discovery**, **Azure SQL enhancements**, and **PowerPlatform action execution**.

## Highlights

- **NEW: Azure AD B2C Integration** - Complete user management for B2C tenants
- **NEW: REST API Package** - Generic REST API testing with OAuth2 and OpenAPI support
- **Azure SQL Improvements** - Anti-guessing guidance, optional server/database parameters
- **PowerPlatform Data** - Execute custom actions and APIs

---

## New Features

### Azure AD B2C Integration (NEW PACKAGE)

**Package:** `@mcp-consultant-tools/azure-b2c`

A complete Azure AD B2C user management solution via Microsoft Graph API.

#### Features

- **User Management**: List, search, and get B2C user details
- **Group Operations**: List groups, view memberships, get group members
- **Password Management**: Reset passwords, force change on next login
- **User Lifecycle**: Create, update, and delete users
- **Granular Security**: Four separate flags for different write operation types

#### Tools (11)

| Tool | Description | Requires Flag |
|------|-------------|---------------|
| `b2c-list-users` | List users with pagination | - |
| `b2c-get-user` | Get user by ID or email | - |
| `b2c-search-users` | Search users by name/email | - |
| `b2c-list-groups` | List all groups | - |
| `b2c-get-user-groups` | Get user's group memberships | - |
| `b2c-get-group-members` | Get members of a group | - |
| `b2c-reset-user-password` | Set new password | `AZURE_B2C_ENABLE_PASSWORD_RESET` |
| `b2c-force-password-change` | Force change on next login | `AZURE_B2C_ENABLE_PASSWORD_RESET` |
| `b2c-create-user` | Create new local account | `AZURE_B2C_ENABLE_USER_CREATE` |
| `b2c-update-user` | Update user profile | `AZURE_B2C_ENABLE_USER_UPDATE` |
| `b2c-delete-user` | Delete user (irreversible) | `AZURE_B2C_ENABLE_USER_DELETE` |

#### Prompts (2)

- `b2c-user-overview` - Formatted user profile with groups
- `b2c-tenant-summary` - Tenant statistics

#### Configuration

```bash
# Required
AZURE_B2C_TENANT_ID=your-tenant.onmicrosoft.com
AZURE_B2C_CLIENT_ID=your-app-client-id
AZURE_B2C_CLIENT_SECRET=your-app-secret

# Security flags (all default to false)
AZURE_B2C_ENABLE_PASSWORD_RESET=true
AZURE_B2C_ENABLE_USER_CREATE=true
AZURE_B2C_ENABLE_USER_UPDATE=true
AZURE_B2C_ENABLE_USER_DELETE=true
```

---

### REST API Integration (NEW PACKAGE)

**Package:** `@mcp-consultant-tools/rest-api`

Generic REST API testing with OAuth2 client credentials support.

#### Features

- **OpenAPI Auto-Discovery**: Point to swagger.json and all endpoints are auto-discovered
- **OAuth2 Support**: Client credentials flow with automatic token refresh
- **Multiple Auth Methods**: OAuth2, Bearer token, Basic auth, API key
- **Request Methods**: GET, POST, PUT, PATCH, DELETE

#### Tools (4)

- `rest-get` - GET request with query parameters
- `rest-post` - POST request with JSON body
- `rest-put` - PUT request with JSON body
- `rest-delete` - DELETE request

#### Configuration

```bash
REST_BASE_URL=https://your-api.example.com/api
REST_OPENAPI_URL=https://your-api.example.com/swagger/v1/swagger.json

# OAuth2 (recommended)
OAUTH2_TOKEN_URL=https://login.microsoftonline.com/{tenant}/oauth2/v2.0/token
OAUTH2_CLIENT_ID=your-client-id
OAUTH2_CLIENT_SECRET=your-client-secret
OAUTH2_SCOPE=api://your-app-id/.default
```

---

### PowerPlatform Data: Execute Action Tool

**Package:** `@mcp-consultant-tools/powerplatform-data`

New tool for executing Dataverse actions and custom APIs.

#### Tool: execute-action

- **Unbound Actions**: Execute global actions (e.g., `WhoAmI`, custom APIs)
- **Bound Actions**: Execute entity-specific actions (e.g., `WinOpportunity`)
- **Input/Output Parameters**: Full parameter support

```bash
POWERPLATFORM_ENABLE_ACTIONS=true  # Enable execute-action tool
```

PowerPlatform Data now has **4 tools**: `create-record`, `update-record`, `delete-record`, `execute-action`

---

### Azure SQL Enhancements

**Package:** `@mcp-consultant-tools/azure-sql`

#### Anti-Guessing Guidance

All tools now include detailed guidance to prevent AI agents from guessing server/database names. Tool descriptions explicitly state available servers and databases.

#### Optional Server/Database Parameters

All tools now accept optional `serverId` and `database` parameters:
- If omitted: Uses currently connected server/database
- If provided: Switches context to specified server/database

---

## Breaking Changes

None - all changes are backward compatible.

## Migration Guide

### From v21.x

No migration required. Simply update your package versions:

```bash
npm install @mcp-consultant-tools/powerplatform@22.0.0
npm install @mcp-consultant-tools/azure-sql@22.0.0
# ... etc
```

### New Packages (Optional)

Install new packages if you need their functionality:

```bash
npm install @mcp-consultant-tools/azure-b2c@22.0.0
npm install @mcp-consultant-tools/rest-api@22.0.0
```

## Package Versions

| Package | Version |
|---------|---------|
| @mcp-consultant-tools/core | 22.0.0 |
| @mcp-consultant-tools/azure-b2c | 22.0.0 |
| @mcp-consultant-tools/azure-sql | 22.0.0 |
| @mcp-consultant-tools/rest-api | 22.0.0 |
| @mcp-consultant-tools/powerplatform-data | 22.0.0 |
| mcp-consultant-tools (meta) | 22.0.0 |

Packages without changes remain at their current versions (20.0.0 or 21.0.0).

## Support

Report issues at: https://github.com/klemensms/mcp-consultant-tools/issues
