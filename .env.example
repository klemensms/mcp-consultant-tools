# PowerPlatform/Dataverse Configuration
# Copy this file to .env and fill in your actual values

# Your PowerPlatform environment URL
# Example: https://yourorg.crm.dynamics.com or https://yourorg.crm4.dynamics.com
POWERPLATFORM_URL=https://yourorg.crm.dynamics.com

# Azure AD App Registration Details
POWERPLATFORM_CLIENT_ID=your-client-id-here
POWERPLATFORM_CLIENT_SECRET=your-client-secret-here
POWERPLATFORM_TENANT_ID=your-tenant-id-here

# =============================================================================
# PowerPlatform Feature Flags
# =============================================================================

# Enable metadata customization tools (create entities, attributes, forms, views, etc.)
# WARNING: These make permanent schema changes to your Dataverse environment.
POWERPLATFORM_ENABLE_CUSTOMIZATION=true

# Default solution to add customizations to (optional)
POWERPLATFORM_DEFAULT_SOLUTION=YourSolutionName

# Enable data CRUD operations (create, update, delete records)
# WARNING: These allow AI agents to modify data in your Dataverse environment.
# Only enable in development/sandbox environments or with proper safeguards.
# Default: false for all

# Enable record creation (POST operations)
POWERPLATFORM_ENABLE_CREATE=false

# Enable record updates (PATCH operations)
POWERPLATFORM_ENABLE_UPDATE=false

# Enable record deletion (DELETE operations - permanent and irreversible)
POWERPLATFORM_ENABLE_DELETE=false

# =============================================================================
# Azure DevOps Configuration (Optional)
# Required only if using Azure DevOps wiki and work item features

# Azure DevOps organization name (from https://dev.azure.com/<organization>)
AZUREDEVOPS_ORGANIZATION=your-organization-name

# Personal Access Token (PAT) with Read access to wikis and work items
# Create at: https://dev.azure.com/<organization>/_usersSettings/tokens
AZUREDEVOPS_PAT=your-personal-access-token-here

# Comma-separated list of allowed projects
AZUREDEVOPS_PROJECTS=Project1,Project2

# API version (default: 7.1)
AZUREDEVOPS_API_VERSION=7.1

# Feature flags (default: false)
AZUREDEVOPS_ENABLE_WORK_ITEM_WRITE=false
AZUREDEVOPS_ENABLE_WORK_ITEM_DELETE=false
AZUREDEVOPS_ENABLE_WIKI_WRITE=false

# =============================================================================
# Figma Configuration (Optional)
# =============================================================================

# Figma Personal Access Token (PAT)
# Generate at: https://www.figma.com/developers/api#authentication
# Required if not using OAuth
FIGMA_API_KEY=your_figma_personal_access_token_here

# Figma OAuth Token (Alternative to API Key)
# Use this if authenticating via OAuth instead of PAT
FIGMA_OAUTH_TOKEN=

# Use OAuth Authentication (true/false)
# Set to "true" if using FIGMA_OAUTH_TOKEN instead of FIGMA_API_KEY
FIGMA_USE_OAUTH=false

# =============================================================================
# Azure Application Insights Configuration (Optional)
# =============================================================================

# Authentication method: 'entra-id' (recommended) or 'api-key'
APPINSIGHTS_AUTH_METHOD=entra-id

# For Entra ID authentication (recommended - higher rate limits)
APPINSIGHTS_TENANT_ID=your-azure-tenant-id
APPINSIGHTS_CLIENT_ID=your-azure-app-client-id
APPINSIGHTS_CLIENT_SECRET=your-azure-app-client-secret

# Application Insights resources configuration (JSON array)
# Each resource needs: id, name, appId, active (true/false)
APPINSIGHTS_RESOURCES=[{"id":"prod-api","name":"Production API","appId":"your-app-id","active":true}]

# Alternative: Single resource configuration (fallback)
APPINSIGHTS_APP_ID=your-app-id
APPINSIGHTS_API_KEY=your-api-key

# =============================================================================
# Azure SQL Database Configuration (Optional)
# =============================================================================

# Azure SQL Server name (without .database.windows.net)
# Example: myserver.database.windows.net
AZURE_SQL_SERVER=myserver.database.windows.net

# Database name
AZURE_SQL_DATABASE=mydatabase

# SQL Server port (default: 1433)
AZURE_SQL_PORT=1433

# =============================================================================
# SQL Authentication Method 1: SQL Authentication (username/password)
# =============================================================================
AZURE_SQL_USERNAME=mcp_readonly
AZURE_SQL_PASSWORD=SecurePassword123!

# =============================================================================
# SQL Authentication Method 2: Azure AD Authentication (recommended for production)
# =============================================================================
# Set to "true" to use Azure AD authentication
AZURE_SQL_USE_AZURE_AD=false

# Azure AD App Registration Details (required if using Azure AD auth)
AZURE_SQL_CLIENT_ID=your-azure-app-client-id
AZURE_SQL_CLIENT_SECRET=your-azure-app-client-secret
AZURE_SQL_TENANT_ID=your-azure-tenant-id

# =============================================================================
# SQL Query Safety Limits
# =============================================================================
# Query timeout in milliseconds (default: 30000 = 30 seconds)
AZURE_SQL_QUERY_TIMEOUT=30000

# Maximum rows returned per query (default: 1000)
AZURE_SQL_MAX_RESULT_ROWS=1000

# Connection timeout in milliseconds (default: 15000 = 15 seconds)
AZURE_SQL_CONNECTION_TIMEOUT=15000

# =============================================================================
# SQL Connection Pool Settings (Optional)
# =============================================================================
# Minimum pool connections (default: 0)
AZURE_SQL_POOL_MIN=0

# Maximum pool connections (default: 10)
AZURE_SQL_POOL_MAX=10

# =============================================================================
# Azure Log Analytics Workspace Configuration (Optional)
# =============================================================================

# Authentication method: 'entra-id' (recommended) or 'api-key'
LOGANALYTICS_AUTH_METHOD=entra-id

# For Entra ID authentication (recommended - higher rate limits)
# Note: You can reuse the same credentials from Application Insights if using the same app registration
LOGANALYTICS_TENANT_ID=your-azure-tenant-id
LOGANALYTICS_CLIENT_ID=your-azure-app-client-id
LOGANALYTICS_CLIENT_SECRET=your-azure-app-client-secret

# Log Analytics workspaces configuration (JSON array)
# Each workspace needs: id, name, workspaceId, active (true/false)
LOGANALYTICS_RESOURCES=[{"id":"prod-functions","name":"Production Functions","workspaceId":"12345678-1234-1234-1234-123456789012","active":true}]

# Alternative: Single workspace configuration (fallback)
LOGANALYTICS_WORKSPACE_ID=12345678-1234-1234-1234-123456789012
LOGANALYTICS_API_KEY=your-api-key-if-using-api-key-auth

# =============================================================================
# Azure Service Bus Configuration (Optional)
# =============================================================================

# Authentication method: 'entra-id' (recommended) or 'connection-string'
SERVICEBUS_AUTH_METHOD=entra-id

# For Entra ID authentication (recommended - better security)
# Note: You can reuse the same credentials from Application Insights if using the same app registration
SERVICEBUS_TENANT_ID=your-azure-tenant-id
SERVICEBUS_CLIENT_ID=your-azure-app-client-id
SERVICEBUS_CLIENT_SECRET=your-azure-app-client-secret

# Service Bus namespaces configuration (JSON array)
# Each namespace needs: id, name, namespace, active (true/false)
SERVICEBUS_RESOURCES=[{"id":"prod","name":"Production Service Bus","namespace":"prod-namespace.servicebus.windows.net","active":true}]

# Alternative: Single namespace configuration (fallback)
SERVICEBUS_NAMESPACE=prod-namespace.servicebus.windows.net
SERVICEBUS_CONNECTION_STRING=Endpoint=sb://prod-namespace.servicebus.windows.net/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=your-key-here

# =============================================================================
# Service Bus Security & Performance Options (Optional)
# =============================================================================

# Sanitize message bodies and properties (default: false)
# Set to "true" when working with production data containing PII
SERVICEBUS_SANITIZE_MESSAGES=false

# Maximum messages to peek in one operation (default: 100)
SERVICEBUS_MAX_PEEK_MESSAGES=100

# Maximum messages to search (default: 500)
SERVICEBUS_MAX_SEARCH_MESSAGES=500

# Peek operation timeout in milliseconds (default: 30000 = 30 seconds)
SERVICEBUS_PEEK_TIMEOUT=30000

# Retry settings for transient failures
SERVICEBUS_RETRY_MAX_ATTEMPTS=3
SERVICEBUS_RETRY_DELAY=1000

# Queue list cache time-to-live in seconds (default: 300 = 5 minutes)
SERVICEBUS_CACHE_QUEUE_LIST_TTL=300

# =============================================================================
# GitHub Enterprise Configuration (Optional)
# =============================================================================

# GitHub Enterprise URL (e.g., https://github.yourcompany.com)
GHE_URL=https://github.yourcompany.com

# Personal Access Token (PAT) - recommended authentication method
GHE_PAT=ghp_your_personal_access_token_here

# Authentication method: 'pat' (recommended) or 'github-app'
GHE_AUTH_METHOD=pat

# Repository configuration (JSON array)
# Each repo needs: id, owner, repo, defaultBranch (optional), active (true/false)
GHE_REPOS=[{"id":"plugin-core","owner":"yourorg","repo":"PluginCore","defaultBranch":"release/9.0","active":true}]

# Caching configuration
GHE_ENABLE_CACHE=true
GHE_CACHE_TTL=300

# Write permissions (default: false)
GHE_ENABLE_WRITE=false
GHE_ENABLE_CREATE=false

# =============================================================================
# SharePoint Online Configuration (Optional)
# =============================================================================

# Authentication (Entra ID / OAuth 2.0)
# Note: Can reuse Application Insights/Log Analytics credentials if using same app registration
SHAREPOINT_TENANT_ID=your-azure-tenant-id
SHAREPOINT_CLIENT_ID=your-azure-app-client-id
SHAREPOINT_CLIENT_SECRET=your-azure-app-client-secret

# Multi-site configuration (JSON array)
# Each site needs: id, name, siteUrl, active (true/false), description (optional)
SHAREPOINT_SITES=[{"id":"intranet","name":"Company Intranet","siteUrl":"https://yourtenant.sharepoint.com/sites/intranet","active":true}]

# Alternative: Single-site configuration (fallback)
SHAREPOINT_SITE_URL=https://yourtenant.sharepoint.com/sites/intranet

# =============================================================================
# SharePoint Optional Configuration
# =============================================================================

# Cache time-to-live in seconds (default: 300 = 5 minutes)
SHAREPOINT_CACHE_TTL=300

# Maximum search results (default: 100)
SHAREPOINT_MAX_SEARCH_RESULTS=100

# Search timeout in milliseconds (default: 30000 = 30 seconds)
SHAREPOINT_SEARCH_TIMEOUT=30000
